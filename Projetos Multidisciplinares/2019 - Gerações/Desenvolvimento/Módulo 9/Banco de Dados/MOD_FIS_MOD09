/* MOD_LOG_MOD09: */

CREATE TABLE INCIDENTES (
    INC_DATA_HORA datetime,
    INC_ID integer PRIMARY KEY,
    FK_TIPOS_INCIDENTES_TIP_ID integer,
    FK_IDOSOS_IDO_ID integer
);

CREATE TABLE TIPOS_INCIDENTES (
    TIP_INC_DESCRICAO VARCHAR(200),
    TIP_ID integer PRIMARY KEY
);

CREATE TABLE IDOSOS (
    IDO_NOME varchar(100),
    IDO_ID integer PRIMARY KEY
);

CREATE TABLE SERVIDOR_EMAIL (
    EML_ID integer PRIMARY KEY,
    EML_CONFIGURACOES varchar(50)
);

CREATE TABLE DOACOES (
    DOA_ID integer PRIMARY KEY,
    DOA_NOME_DOADOR varchar(100)
);

CREATE TABLE DOACOES_VALOR (
    VAL_VALOR float,
    VAL_ID INTEGER,
    FK_DOACOES_DOA_ID integer,
    PRIMARY KEY (VAL_ID, FK_DOACOES_DOA_ID)
);

CREATE TABLE DOACOES_PRODUTOS (
    PRO_ID INTEGER,
    FK_DOACOES_DOA_ID integer,
    PRIMARY KEY (PRO_ID, FK_DOACOES_DOA_ID)
);

CREATE TABLE LIMPEZA (
    LIM_ID INTEGER PRIMARY KEY,
    LIM_DATA datetime,
    FK_SETORES_LIMPEZA_SET_ID integer
);

CREATE TABLE RESPONSAVEL_LIMPEZA (
    REL_ID integer PRIMARY KEY
);

CREATE TABLE SETORES_LIMPEZA (
    SET_ID integer PRIMARY KEY
);

CREATE TABLE PRODUTOS (
    PRO_DOADO_NOME VARCHAR(100),
    PRO_DOADO_ID INTEGER PRIMARY KEY,
    FK_TIPO_PRODUTOS_TIP_PRODUTO_ID INTEGER
);

CREATE TABLE TIPO_PRODUTOS (
    TIP_PRODUTO_NOME VARCHAR(50),
    TIP_PRODUTO_ID INTEGER PRIMARY KEY
);

CREATE TABLE PRODUTOS_DOADOS (
    FK_PRODUTOS_PRO_DOADO_ID INTEGER,
    FK_DOACOES_PRODUTOS_PRO_ID INTEGER,
    FK_DOACOES_PRODUTOS_FK_DOACOES_DOA_ID integer,
    PDO_ID integer PRIMARY KEY,
    QNT_PROD_DOADOS integer
);
 
ALTER TABLE INCIDENTES ADD CONSTRAINT FK_INCIDENTES_2
    FOREIGN KEY (FK_TIPOS_INCIDENTES_TIP_ID)
    REFERENCES TIPOS_INCIDENTES (TIP_ID)
    ON DELETE CASCADE;
 
ALTER TABLE INCIDENTES ADD CONSTRAINT FK_INCIDENTES_3
    FOREIGN KEY (FK_IDOSOS_IDO_ID)
    REFERENCES IDOSOS (IDO_ID)
    ON DELETE CASCADE;
 
ALTER TABLE DOACOES_VALOR ADD CONSTRAINT FK_DOACOES_VALOR_2
    FOREIGN KEY (FK_DOACOES_DOA_ID)
    REFERENCES DOACOES (DOA_ID)
    ON DELETE CASCADE;
 
ALTER TABLE DOACOES_PRODUTOS ADD CONSTRAINT FK_DOACOES_PRODUTOS_2
    FOREIGN KEY (FK_DOACOES_DOA_ID)
    REFERENCES DOACOES (DOA_ID)
    ON DELETE CASCADE;
 
ALTER TABLE LIMPEZA ADD CONSTRAINT FK_LIMPEZA_2
    FOREIGN KEY (FK_SETORES_LIMPEZA_SET_ID)
    REFERENCES SETORES_LIMPEZA (SET_ID)
    ON DELETE CASCADE;
 
ALTER TABLE PRODUTOS ADD CONSTRAINT FK_PRODUTOS_2
    FOREIGN KEY (FK_TIPO_PRODUTOS_TIP_PRODUTO_ID)
    REFERENCES TIPO_PRODUTOS (TIP_PRODUTO_ID)
    ON DELETE CASCADE;
 
ALTER TABLE PRODUTOS_DOADOS ADD CONSTRAINT FK_PRODUTOS_DOADOS_2
    FOREIGN KEY (FK_PRODUTOS_PRO_DOADO_ID)
    REFERENCES PRODUTOS (PRO_DOADO_ID)
    ON DELETE SET NULL;
 
ALTER TABLE PRODUTOS_DOADOS ADD CONSTRAINT FK_PRODUTOS_DOADOS_3
    FOREIGN KEY (FK_DOACOES_PRODUTOS_PRO_ID, FK_DOACOES_PRODUTOS_FK_DOACOES_DOA_ID)
    REFERENCES DOACOES_PRODUTOS (PRO_ID, FK_DOACOES_DOA_ID)
    ON DELETE SET NULL;